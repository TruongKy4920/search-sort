#include <iostream>
#include <fstream>
#include <string>
#include <sstream>
#include <iomanip>
#include <math.h>
#include <algorithm>
#include <stack>
#define MAX 100
using namespace std;

std::ifstream input("input.txt");
std::ofstream output("output.txt");
int n,m;
int a[MAX][MAX];
char x[MAX],y[MAX];

void print(){
 
}

void solution(){
  //bai toan co so nho nhat la khi x lan y chua co ki tu nao
  for(int i=0;i<=n;i++) a[i][0]=0; //gan hang doc khi x chua co ki tu nao bang 0
  for(int j=0;j<=m;j++) a[0][j]=0; //gan hang ngang khi y chua co ki tu nao bang 0

  for(int i=1;i<=n;i++){
    for(int j=1;j<=m;j++){
      if(x[i]==y[j]){
          a[i][j]=a[i-1][j-1]+1;
      }
      else a[i][j]= max(a[i-1][j],a[i][j-1]);
    }
  }
  int i=n;
  int j=m;
  while(a[i][j]!=0){
    if(x[i]==y[j]) {
      output<<x[i]<<" ";
      j--;
      i--;
    }
    else{
      if(a[i-1][j]>a[i][j-1]) i--;
      else j--;
    }
  }
  output<<"\n";
  output<<a[n][m];
}

int main(){
    std::string line;
    input>>n>>m;
    for(int i=1;i<=n;i++) input>>x[i];
    for(int j=1;j<=m;j++) input>>y[j];
    solution();


  
  for(int i=0;i<=n;i++){
    for(int j=0;j<=m;j++){
      cout<<a[i][j]<<" ";
    }
    cout<<"\n";
  }

    
      
      
      
} 